# Copyright 2021-2022 VMware, Inc.
# SPDX-License-Identifier: BSD-2-Clause
---
# Remove the VM vmware.log file firstly and then
# create an empty new one.
# Parameters:
#   vm_vmware_log_path: the relative vmware.log file path
#   in datastore.
#
- name: Remove VM vmware.log in VM folder 
  community.vmware.vsphere_file:
    host: "{{ vsphere_host_name }}"
    username: "{{ vsphere_host_user }}"
    password: "{{ vsphere_host_user_password }}"
    validate_certs: "{{ validate_certs | default(False) }}"
    datacenter: "{{ vsphere_host_datacenter }}"
    datastore: "{{ dest_datastore | default(datastore) }}"
    path: "{{ vm_vmware_log_path }}"
    state: absent
  register: remove_vmware_log
- name: Print the result of removing vmware.log file
  debug: var=remove_vmware_log

- name: Create an empty vmware.log in VM folder
  community.vmware.vsphere_file:
    host: "{{ vsphere_host_name }}"
    username: "{{ vsphere_host_user }}"
    password: "{{ vsphere_host_user_password }}"
    validate_certs: "{{ validate_certs | default(False) }}"
    datacenter: "{{ vsphere_host_datacenter }}"
    datastore: "{{ dest_datastore | default(datastore) }}"
    path: "{{ vm_vmware_log_path }}"
    state: touch
  register: new_vmware_log
- name: Print the result of creating vmware.log file
  debug: var=new_vmware_log
